#Ejecutar R con 12GB de memoria RAM
options(java.parameters="-Xmx12g")

#Cargamos la librer√≠a correspondiente
library(dplyr)
#Seleccionamos los campos de nuestro dataset
df<-select(
	df
	,"age"
	,"gender"
	,"arrivalmode"
	,"triage_vital_hr"
	,"triage_vital_sbp"
	,"triage_vital_dbp"
	,"triage_vital_rr"
	,"triage_vital_o2"
	,"triage_vital_temp"
	,"esi"
	,"previousdispo"
	,"n_edvisits"
	,"n_admissions"
	,"n_surgeries"
	,"cc_abdominalcramping"
	,"cc_abdominaldistention"
	,"cc_abdominalpain"
	,"cc_abdominalpainpregnant"
	,"cc_abnormallab"
	,"cc_abscess"
	,"cc_addictionproblem"
	,"cc_agitation"
	,"cc_alcoholintoxication"
	,"cc_alcoholproblem"
	,"cc_allergicreaction"
	,"cc_alteredmentalstatus"
	,"cc_animalbite"
	,"cc_ankleinjury"
	,"cc_anklepain"
	,"cc_anxiety"
	,"cc_arminjury"
	,"cc_armpain"
	,"cc_armswelling"
	,"cc_assaultvictim"
	,"cc_asthma"
	,"cc_backpain"
	,"cc_bleeding/bruising"
	,"cc_blurredvision"
	,"cc_bodyfluidexposure"
	,"cc_breastpain"
	,"cc_breathingdifficulty"
	,"cc_breathingproblem"
	,"cc_burn"
	,"cc_cardiacarrest"
	,"cc_cellulitis"
	,"cc_chestpain"
	,"cc_chesttightness"
	,"cc_chills"
	,"cc_coldlikesymptoms"
	,"cc_confusion"
	,"cc_conjunctivitis"
	,"cc_constipation"
	,"cc_cough"
	,"cc_cyst"
	,"cc_decreasedbloodsugar-symptomatic"
	,"cc_dehydration"
	,"cc_dentalpain"
	,"cc_depression"
	,"cc_detoxevaluation"
	,"cc_diarrhea"
	,"cc_dizziness"
	,"cc_drug/alcoholassessment"
	,"cc_drugproblem"
	,"cc_dyspnea"
	,"cc_dysuria"
	,"cc_earpain"
	,"cc_earproblem"
	,"cc_edema"
	,"cc_elbowpain"
	,"cc_elevatedbloodsugar-nosymptoms"
	,"cc_elevatedbloodsugar-symptomatic"
	,"cc_emesis"
	,"cc_epigastricpain"
	,"cc_epistaxis"
	,"cc_exposuretostd"
	,"cc_extremitylaceration"
	,"cc_extremityweakness"
	,"cc_eyeinjury"
	,"cc_eyepain"
	,"cc_eyeproblem"
	,"cc_eyeredness"
	,"cc_facialinjury"
	,"cc_faciallaceration"
	,"cc_facialpain"
	,"cc_facialswelling"
	,"cc_fall"
	,"cc_fatigue"
	,"cc_femaleguproblem"
	,"cc_fever"
	,"cc_fever-75yearsorolder"
	,"cc_fever-9weeksto74years"
	,"cc_feverimmunocompromised"
	,"cc_fingerinjury"
	,"cc_fingerpain"
	,"cc_fingerswelling"
	,"cc_flankpain"
	,"cc_follow-upcellulitis"
	,"cc_footinjury"
	,"cc_footpain"
	,"cc_footswelling"
	,"cc_foreignbodyineye"
	,"cc_fulltrauma"
	,"cc_generalizedbodyaches"
	,"cc_gibleeding"
	,"cc_giproblem"
	,"cc_groinpain"
	,"cc_hallucinations"
	,"cc_handinjury"
	,"cc_handpain"
	,"cc_headache"
	,"cc_headache-newonsetornewsymptoms"
	,"cc_headache-recurrentorknowndxmigraines"
	,"cc_headachere-evaluation"
	,"cc_headinjury"
	,"cc_headlaceration"
	,"cc_hematuria"
	,"cc_hemoptysis"
	,"cc_hippain"
	,"cc_homicidal"
	,"cc_hyperglycemia"
	,"cc_hypertension"
	,"cc_hypotension"
	,"cc_influenza"
	,"cc_ingestion"
	,"cc_insectbite"
	,"cc_irregularheartbeat"
	,"cc_jawpain"
	,"cc_jointswelling"
	,"cc_kneeinjury"
	,"cc_kneepain"
	,"cc_laceration"
	,"cc_leginjury"
	,"cc_legpain"
	,"cc_legswelling"
	,"cc_lethargy"
	,"cc_lossofconsciousness"
	,"cc_maleguproblem"
	,"cc_mass"
	,"cc_medicalproblem"
	,"cc_medicalscreening"
	,"cc_medicationproblem"
	,"cc_medicationrefill"
	,"cc_migraine"
	,"cc_modifiedtrauma"
	,"cc_motorcyclecrash"
	,"cc_motorvehiclecrash"
	,"cc_multiplefalls"
	,"cc_nasalcongestion"
	,"cc_nausea"
	,"cc_nearsyncope"
	,"cc_neckpain"
	,"cc_neurologicproblem"
	,"cc_numbness"
	,"cc_oralswelling"
	,"cc_otalgia"
	,"cc_other"
	,"cc_overdose-accidental"
	,"cc_overdose-intentional"
	,"cc_pain"
	,"cc_palpitations"
	,"cc_panicattack"
	,"cc_pelvicpain"
	,"cc_poisoning"
	,"cc_post-opproblem"
	,"cc_psychiatricevaluation"
	,"cc_psychoticsymptoms"
	,"cc_rapidheartrate"
	,"cc_rash"
	,"cc_rectalbleeding"
	,"cc_rectalpain"
	,"cc_respiratorydistress"
	,"cc_ribinjury"
	,"cc_ribpain"
	,"cc_seizure-newonset"
	,"cc_seizure-priorhxof"
	,"cc_seizures"
	,"cc_shortnessofbreath"
	,"cc_shoulderinjury"
	,"cc_shoulderpain"
	,"cc_sicklecellpain"
	,"cc_sinusproblem"
	,"cc_skinirritation"
	,"cc_skinproblem"
	,"cc_sorethroat"
	,"cc_stdcheck"
	,"cc_strokealert"
	,"cc_suicidal"
	,"cc_suture/stapleremoval"
	,"cc_swallowedforeignbody"
	,"cc_syncope"
	,"cc_tachycardia"
	,"cc_testiclepain"
	,"cc_thumbinjury"
	,"cc_tickremoval"
	,"cc_toeinjury"
	,"cc_toepain"
	,"cc_trauma"
	,"cc_unresponsive"
	,"cc_uri"
	,"cc_urinaryfrequency"
	,"cc_urinaryretention"
	,"cc_urinarytractinfection"
	,"cc_vaginalbleeding"
	,"cc_vaginaldischarge"
	,"cc_vaginalpain"
	,"cc_weakness"
	,"cc_wheezing"
	,"cc_withdrawal-alcohol"
	,"cc_woundcheck"
	,"cc_woundinfection"
	,"cc_woundre-evaluation"
	,"cc_wristinjury"
	,"cc_wristpain"
	,"cxr_count"
	,"echo_count"
	,"ekg_count"
	,"headct_count"
	,"mri_count"
	,"otherct_count"
	,"otherimg_count"
	,"otherus_count"
	,"otherxr_count"
	)

#Redondeamos la edad
df[,'age']<-round(df[,'age'],digits=-1)

#Convertimos grados Fahrenheit a Celsius
b[,'triage_vital_temp']<-(b[,'triage_vital_temp']-32)*5/9

#Redondeamos temperatura
b[,'triage_vital_temp']<-round(b[,'triage_vital_temp'],1)

#Quitamos nulls de la clase a predecir
df<-df[complete.cases(df[,'esi']),]

#Creo varios subsets para entrenar
a<-head(df,100000)
b<-head(df,50000)
c<-head(df,25000)
d<-head(df,10000)
f<-head(df,1000)

#Exporto a formato arff de weka
library(RWeka)
write.arff(df,file="Datos.arff")
write.arff(a,file="100000.arff")
write.arff(b,file="50000.arff")
write.arff(c,file="25000.arff")
write.arff(d,file="10000.arff")
write.arff(f,file="1000.arff")